execute_process(
    COMMAND /bin/bash ${CMAKE_CURRENT_LIST_DIR}/build.sh
    RESULT_VARIABLE TOOLCHAIN_BUILD_FAILED
)

if (TOOLCHAIN_BUILD_FAILED)
    message(FATAL_ERROR "-- Toolchain build error.")
endif()

set(CMAKE_SYSTEM_PROCESSOR 86)

set(TOOLCHAIN_PATH     "${CMAKE_CURRENT_LIST_DIR}")
set(CMAKE_C_COMPILER   "${TOOLCHAIN_PATH}/CrossCompiler/Tools/bin/i686-elf-gcc")
set(CMAKE_CXX_COMPILER "${TOOLCHAIN_PATH}/CrossCompiler/Tools/bin/i686-elf-g++")

set(LINKER_FLAGS "-Wl,--oformat=binary -ffreestanding -O2 -nostdlib")
set(CXX_FLAGS "-std=c++17 -ffreestanding -O2 -Wall -Wextra -Werror -fno-use-cxa-atexit -fno-rtti -fno-exceptions")
set(CMAKE_EXE_LINKER_FLAGS_INIT "${LINKER_FLAGS}")
set(CMAKE_CXX_FLAGS         ${CXX_FLAGS})
set(CMAKE_CXX_FLAGS_DEBUG   ${CXX_FLAGS})
set(CMAKE_CXX_FLAGS_RELEASE ${CXX_FLAGS})
